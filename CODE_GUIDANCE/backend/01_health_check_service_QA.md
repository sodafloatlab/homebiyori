# `health_check_service` Q&A集

このドキュメントは、`health_check_service`の各ファイルに関する技術的な疑問点とその回答をまとめたものです。

---

## `main.py` に関するQ&A

### Q: `@app.get("/health")` は何ですか？

**A:** これはFastAPIの**「デコレータ」**と呼ばれる機能です。直後にある`basic_health_check`関数に対して、**「`/health`というURLへのGETリクエストをあなたが担当しなさい」**という役割を与えるための「飾り付け」です。

FastAPIは、このデコレータを見て、特定のURLとそれを処理する関数を内部で自動的に紐付けます。これにより、関数の本体のコード（ビジネスロジック）と、その関数を呼び出すためのURL定義を、分離してきれいに記述することができます。

### Q: なぜヘルスチェックAPIが必要なのですか？

**A:** ヘルスチェックAPIは、システムの「体温計」のようなものです。主に以下の2つの重要な目的で使われます。

1.  **死活監視**: ロードバランサーやコンテナオーケストレーター（ECS, Kubernetesなど）といったインフラ基盤が、定期的にこのAPIを叩きます。もし正常な応答（`{"status": "ok"}`）が返ってこなければ、「このサービスは不健康だ」と判断し、自動的に再起動したり、トラフィックを他の正常なインスタンスに振り分けたりします。
2.  **デプロイ確認**: 新しいバージョンをデプロイした直後に、このAPIを叩くことで、サービスが正常に起動しているかを簡単に確認できます。

このように、システムの安定運用と自動復旧を実現するために、ヘルスチェックは不可欠な存在です。

---

## `handler.py` に関するQ&A

### Q: `Mangum`とは何ですか？ なぜ必要なのですか？

**A:** `Mangum`は、FastAPIのような**ASGIフレームワーク**を、**AWS Lambda**上で動作させるためのアダプターライブラリです。

- **背景**: FastAPIは本来、HTTPサーバー上で動作するように設計されています。一方、LambdaはHTTPサーバーではなく、特定のイベントをトリガーにコードを実行する環境です。両者の「お作法」は全く異なります。
- **役割**: `Mangum`は、Lambdaが受け取るイベント（JSON）を、FastAPIが期待するHTTPリクエストの形式に「翻訳」し、FastAPIからのレスポンスを、Lambdaが返すべき正しい形式に「逆翻訳」してくれます。

`handler = Mangum(app)`という一行を書くだけで、この面倒な翻訳作業をすべて裏側で担当してくれるため、開発者はLambdaであることを意識せず、通常のFastAPIアプリケーションとしてコードを書くことに集中できるのです。
