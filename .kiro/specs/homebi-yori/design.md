# 設計書 - Homebiyori（ほめびより）

## 概要

「Homebiyori（ほめびより）」は、育児中の親をAIが優しく褒めてくれるWebアプリケーションです。主役は子供ではなく親であり、押し付けがましくない優しさで育児のやる気や自己肯定感を高めることを目的としています。Next.js 14とFastAPIを使用したモダンなサーバーレスWebアプリケーションとして設計し、AWSクラウドインフラストラクチャ上で運用します。

## 設計書構成

この設計書は、保守性と理解しやすさを考慮して以下の専門分野別ファイルに分割されています：

### 📋 設計書一覧

1. **[design_architecture.md](./design_architecture.md)** - システムアーキテクチャ設計
   - システム全体構成図
   - 技術スタック詳細
   - アーキテクチャパターンと設計原則

2. **[design_frontend.md](./design_frontend.md)** - フロントエンド設計
   - ディレクトリ構成
   - コンポーネント設計
   - メンテナンス処理

3. **[design_backend.md](./design_backend.md)** - バックエンド設計
   - Lambda分割戦略
   - セキュリティレイヤー構成
   - Lambda間内部通信

4. **[design_database.md](./design_database.md)** - データベース設計
   - DynamoDB 7テーブル構成
   - データアクセスパターン
   - TTL管理戦略

5. **[design_api.md](./design_api.md)** - API設計
   - エンドポイント一覧
   - リクエスト/レスポンス仕様
   - 認証・認可方式

6. **[design_ai.md](./design_ai.md)** - AI機能設計
   - AIキャラクターシステム
   - 感情検出システム
   - 木の成長システム

7. **[design_prompt.md](./design_prompt.md)** - AIプロンプト設計
   - プロンプトアーキテクチャ詳細
   - キャッシュ最適化戦略
   - 動的応答制御システム

8. **[design_security.md](./design_security.md)** - セキュリティ設計
   - 認証・認可システム
   - データ保護
   - プライバシー保護

9. **[design_operations.md](./design_operations.md)** - 運用・監視設計
   - パフォーマンス最適化
   - 監視・アラート
   - コスト最適化

10. **[design_payment.md](./design_payment.md)** - 決済システム設計
   - Stripe連携仕様
   - サブスクリプション管理
   - 課金フロー

## 主要な設計決定事項

### アーキテクチャの特徴
- **サーバーレス構成**: AWS Lambda + API Gateway + DynamoDB
- **マイクロサービス**: 機能別Lambda分割による責務分離
- **モダンフロントエンド**: Next.js 14 App Router + TypeScript

### データ戦略
- **DynamoDB 7テーブル構成**: データ特性別最適化
- **プライバシー重視**: 最小限の個人情報のみ保存
- **TTL管理**: プラン別データ保持期間制御

### AI統合
- **Amazon Bedrock**: Claude 3 Haiku使用
- **3つのAIキャラクター**: たまさん、まどか姉さん、ヒデじい
- **感情検出**: 木の成長と実の生成システム

### セキュリティ
- **Cognito認証**: Google OAuth統合
- **最小権限**: IAM Role分離
- **データ暗号化**: 全レイヤーでの保護

## 設計変更履歴

### v2.0 - DynamoDB 7テーブル構成採用 (2024年)
- 3テーブルから7テーブルへの分割
- プライバシー保護の強化（子供情報削除）
- TTL管理によるデータ保持期間制御
- Lambda責務分離によるマイクロサービス化

## 次のステップ

各設計書の詳細については、上記リンクから対応するファイルを参照してください。実装時は以下の順序で進めることを推奨します：

1. インフラストラクチャ基盤（アーキテクチャ設計）
2. データベース設計の実装
3. バックエンドAPI開発
4. フロントエンド開発
5. AI機能統合
6. セキュリティ実装
7. 運用監視体制構築

詳細な実装計画については `tasks.md` を参照してください。