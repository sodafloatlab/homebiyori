# 要件定義書

## はじめに

「ほめびより」は、育児中の親をAIが優しく褒めてくれるWebアプリケーションです。子どもの笑顔の写真や日常の出来事を投稿すると、AIがその内容を分析して親をポジティブにフィードバックします。主役は子供ではなく親であり、押し付けない優しさをテーマとして、育児のやる気や自己肯定感を高めることを目的としています。

## 要件

### 要件1：AIによる褒め機能

**ユーザーストーリー:** 育児中の親として、日常の出来事や子供の様子をAIに共有して、自分の頑張りを認めてもらいたい

#### 受入基準

1. WHEN ユーザーがテキストで育児の出来事を投稿 THEN システムは投稿内容をAIで分析して褒めのメッセージを生成する
2. WHEN ユーザーが子供の写真を投稿 THEN システムは画像を分析して適切な褒めのメッセージを生成する（**実装優先度：低** - チャット機能実装後）
3. WHEN ユーザーがテキスト投稿で頑張ったことをうまく表現できない場合 THEN システムは「気持ちがまとまらない時は話してみる？」のメッセージでAIチャット相談機能（つぶやきの木陰）への誘導を表示する
4. IF ユーザーが投稿を送信 THEN システムは「静かに喜んでくれる」演出（拍手アニメーションなど）を表示する
5. WHEN 褒めメッセージが初回生成完了 THEN システムは手紙や箱を開けるような演出でメッセージを表示する
6. WHEN AIがメッセージを生成 THEN システムは常に育児だけでなく「人間としての努力」にも言及し、「自分を責めずに一息つけたあなた、ちゃんとえらい」のような表現を心がける

### 要件2：AIロール選択機能

**ユーザーストーリー:** 育児中の親として、自分の状況や気持ちに合ったAIキャラクターから褒めてもらいたい

#### 受入基準

1. WHEN ユーザーがアプリを初回利用 THEN システムは3つのAIロール（たまさん、まどか姉さん、ヒデじい）から選択できる画面を表示する
2. WHEN ユーザーがAIロールを選択 THEN システムは選択されたロールの特性に応じた褒め方でメッセージを生成する
3. WHEN ユーザーが設定画面にアクセス THEN システムはAIロールを変更できる機能を提供する

#### AIロール詳細

- **たまさん（下町のベテランおばちゃん）**
  - テーマカラー：緑
  - 感情の受容力が圧倒的、初産・不安定なユーザーの心を溶かす力
  - 人情味と「大丈夫って言ってほしい人」に最適

- **まどか姉さん（バリキャリ共働きママ）**
  - テーマカラー：赤
  - 論理的な共感＋自己効力感を高める褒め方
  - 忙しい人、自己評価が低いがんばり屋に響く

- **ヒデじい（元教師のやさしい詩人）**
  - テーマカラー：オレンジ
  - 夜に効く、静かな言葉の薬
  - 「行動」ではなく「姿勢」や「人生」に光を当てる

### 要件3：褒めレベル設定機能

**ユーザーストーリー:** 育児中の親として、その時の気持ちや状況に応じて褒めの深度を調整したい

#### 受入基準

1. WHEN ユーザーが投稿画面にアクセス THEN システムは3つの褒めレベル（ライト、スタンダード、ディープ）を選択できる機能を提供する
2. WHEN ユーザーが「ライト」を選択 THEN システムは一言程度の簡潔な褒めメッセージを生成する
3. WHEN ユーザーが「スタンダード」を選択 THEN システムは適度な励ましを含む褒めメッセージを生成する
4. WHEN ユーザーが「ディープ」を選択 THEN システムは深く向き合った丁寧な褒めメッセージを生成する

### 要件4：努力の可視化機能（木の成長UI）

**ユーザーストーリー:** 育児中の親として、自分の日々の努力の積み重ねを視覚的に確認して達成感を得たい

#### 受入基準

1. WHEN ユーザーがダッシュボードにアクセス THEN システムは家族の木を中央に表示し、育児日数に応じて幹の太さ（年輪）で成長を表現する
2. WHEN ユーザーが投稿を行い褒めを受取る THEN システムは木に光る実を1つ追加し、AIロールに応じて実の色を変える（たまさん：緑、まどか姉さん：赤、ヒデじい：オレンジ）
3. WHEN ユーザーが実をタップ THEN システムは褒めメッセージをふんわりと空に浮かび上がる演出で表示する
4. WHEN ユーザーが日付を跨ぐ THEN システムは木の年輪が一回り大きくなるアニメーションを表示する
5. WHEN ユーザーが未投稿の日 THEN システムは光らない実と優しい投稿誘導メッセージを表示する（1日1個まで）
6. WHEN 複数の子供が登録済み THEN システムは木の幹や根に子供の名前を刻んで表示する

### 要件5：AIチャット相談機能（つぶやきの木陰）

**ユーザーストーリー:** 育児中の親として、感情や迷いを現実の人間にはこぼしにくい内容でも、AIに気軽に相談して聞いてもらいたい

#### 受入基準

1. WHEN ユーザーがチャット機能にアクセス THEN システムは「つぶやきの木陰」という名称で機能を提供する
2. WHEN ユーザーがチャット相手を選択 THEN システムは褒め機能と同じAIロール（たまさん、まどか姉さん、ヒデじい）から選択できる機能を提供する
3. WHEN ユーザーが感情アイコンのみ送信 THEN システムは無言でも受け入れる設計でアイコンに応じた適切な反応を返す（例：😔→「その顔…今日はたいへんだったね」）
4. WHEN AIがチャットで応答を生成 THEN システムは過去の投稿履歴（褒めた内容や頑張り）を踏まえて、ユーザーがより親密さを感じることができる応答を生成する
5. WHEN チャットが一区切りついたタイミング THEN システムは会話内容を踏まえて「その気持ちも記録に残しておく？」と褒め機能への投稿誘導メッセージを表示する
6. WHEN ユーザーが医療相談を入力 THEN システムは「ごめんね、わたしにはそれをちゃんと考える力がまだなくて…」と返答し、専門機関への相談を促す
7. WHEN ユーザーがDV・虐待に関する内容を入力 THEN システムは緊急連絡先を提示する導線へ誘導する
8. WHEN AIが回答を生成 THEN システムは「AIの回答は必ずしも正しくない場合があります」という注意書きを明示する

#### AI回答制御原則

- **助言禁止原則**: 教育、人生判断などの専門的アドバイスを一切行わず、共感にとどめる
- **比較禁止原則**: 他者との比較・過去のユーザー行動との評価を避ける
- **領域フィルター**: 医療相談、DV・虐待、離婚・死別などの深刻な人生相談は制限し、適切な対応を行う

#### 機能間の相互補完関係

- **要件1→要件5**: 褒め投稿時に表現に困った場合、チャット相談機能への誘導を行う
- **要件5→要件1**: チャット相談後、感情を整理できた段階で褒め記録への投稿を誘導する
- **データ連携**: チャット応答時に過去の投稿履歴を参照し、「前回の○○のときも頑張っていたよね」のような親密感のある応答を生成する

### 要件6：ユーザー認証・管理機能

**ユーザーストーリー:** 育児中の親として、安全かつ簡単にアプリを利用し、自分のデータを管理したい

#### 受入基準

1. WHEN ユーザーがアプリにアクセス THEN システムはAmazon Cognitoを使用したGoogleアカウント連携認証機能を提供する
2. WHEN ユーザーがログイン画面にアクセス THEN システムは「Googleでログイン」ボタンを表示してワンクリック認証を可能にする
3. WHEN ユーザーがアカウント作成 THEN システムは複数の子供の情報（名前、生年月日など）を登録できる機能を提供する
4. WHEN ユーザーがログイン THEN システムは個人の投稿履歴と努力の可視化データを表示する
5. IF ユーザーがデータ削除を要求 THEN システムは個人データを完全に削除する機能を提供する

### 要件7：ウェルカム体験機能

**ユーザーストーリー:** 育児中の親として、アプリを開いた瞬間から温かく迎えられていると感じたい

#### 受入基準

1. WHEN ユーザーがアプリにアクセス THEN システムは「今日も育児、おつかれさまです」のような温かいメッセージを表示する
2. WHEN ユーザーが初回利用 THEN システムはアプリの使い方を優しく説明するオンボーディングを提供する
3. WHEN ユーザーがアプリを開く THEN システムはユーザーを受け入れる姿勢を明確に示すUIを表示する

### 要件8：レスポンシブデザイン機能

**ユーザーストーリー:** 育児中の親として、スマートフォンでも快適にアプリを利用したい

#### 受入基準

1. WHEN ユーザーがモバイルデバイスでアクセス THEN システムはモバイル最適化されたUIを表示する
2. WHEN ユーザーがタブレットでアクセス THEN システムはタブレット向けに調整されたレイアウトを表示する
3. WHEN ユーザーがデスクトップでアクセス THEN システムはデスクトップ向けの快適なUIを表示する

### 要件9：メンテナンス機能

**ユーザーストーリー:** サービス管理者として、運用上必要な場合にアプリをメンテナンスモードに切り替えたい

#### 受入基準

1. WHEN システムメンテナンスが必要 THEN 管理者はAWS WAFを使用してアプリケーションレイヤーではなくインフラレベルでメンテナンスページを表示できる
2. WHEN メンテナンスモードが有効 THEN システムは全ユーザーに対してメンテナンス中であることを通知し、適切な復旧予定時間を表示する
3. WHEN メンテナンスが完了 THEN 管理者は迅速にメンテナンスモードを解除してサービスを復旧できる

### 要件10：コスト最適化機能

**ユーザーストーリー:** サービス提供者として、スモールスタートでコストを最小限に抑えながらサービスを運営したい

#### 受入基準

1. WHEN システムがDynamoDBを使用 THEN システムはオンデマンド課金モードで運用する
2. WHEN システムがLambdaを使用 THEN システムは最小限のメモリサイズで運用する（ECS Fargateは使用しない）
3. WHEN システムがAWS Bedrockを使用 THEN システムは効率的なプロンプト設計でAPI呼び出し回数を最適化する
4. WHEN システムがS3を使用 THEN システムは適切なライフサイクルポリシーでストレージコストを最適化する